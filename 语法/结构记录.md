# 结构

结构是c#中的一种可以自定义的数据类型。
结构的声明类似于方法，但把返回值类型改为关键字`struct`

```csharp
struct Hero(string Name, int Hp, int Atk)
{

}
```

**顶级语句必须处于所有自定义类型声明的上方。**

## 记录

没有内容的空结构啥也不能做。可以在前面加上记录关键字`record`，使其自动合成一些东西。

```chsarp
record struct Hero(string Name, int Hp, int Atk)
{

}
```

自定义类型的功能非常自由，c#把选择权交给了开发者。
但很多时候，人们就是拿他们单纯的去储存一些数据啥也不干。
于是就做出了记录关键字。被记录修饰的结构会变得像元组一样，
- 参数里的数据会被储存并可以被读取和修改。
- 在`ToString()`时会输出所有参数的名字和值。
- 可以被解构。

## 创建一个记录结构

创建一个结构，要像方法调用一样调用它。
只是这个方法不是从谁的身上调用的，而是凭空的。
所以加一个`new`表示这个过程就是为了创建东西。

```csharp
Hero hero = new Hero("小火龙", 100, 20);
var (name, hp, atk) = hero;
Console.WriteLine(hero);
```

# 类成员

自定义类型内部直属的东西称为类成员。而方法里声明的东西称为局部XX。
区别在于，方法里的东西一旦方法结束，里面声明的东西就没用了，会被清理。
而自定义类型里的东西，是跟随整个类存在的，只有整个类不用了，里面的东西才会被一起清理。

## 只读

成员变量可以用`readonly`修饰为只读。这些值在结构完成初始化后就不能再更改了。

仅对于结构，可以在方法或整个结构上添加`readonly`。

- 只读方法在方法内部，视为所有成员变量都是只读的无法更改。
- 如果结构具有只读，那么所有成员变量都必须是只读的。

这些操作的含义是，结构是值类型，值类型的复制是把所有内容都复制。
在传递给参数时，可能会用引用传递大型结构。
但如果调用方法时绕过了只读，那么c#会把整个结构复制一份给你调用方法，以防止修改内容。

```csharp
record struct MyStruct()
{
	int age;
	readonly string name;

	readonly void Hello()
	{
		Group();//这里会绕过只读权限
	}
	void Group()
	{
		age++;
	}
	void Reference(in MyStruct myStruct)
	{
		myStruct.Hello();//引用传递修改值会影响到原值。
		//in是禁止修改值的。绕过只读会改为复制整个结构。
	}
}
```